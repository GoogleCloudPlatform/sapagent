{
  "id": "r_vulnerability_cve_2019_0357",
  "description": "Check HANA version to see if affected by CVE-2019-0357",
  "labels": [
    "security"
  ],
  "recommendations": [
    {
      "id": "rec_vulnerability_cve_2019_357",
      "trigger": {
        "operation" : "OR",
        "child_evals" : [
          {
            "operation" : "AND",
            "child_evals": [
              {
                "operation" : "EQ",
                "lhs" : "q_hana_version:major",
                "rhs" : "1.0"
              },
              {
                "operation" : "LTE",
                "lhs" : "q_hana_version:revision",
                "rhs" : "122.0"
              },
              {
                "operation" : "LT",
                "lhs" : "q_hana_version:patch",
                "rhs" : "26.0"
              }
            ]
          },
          {
            "operation" : "AND",
            "child_evals": [
              {
                "operation" : "EQ",
                "lhs" : "q_hana_version:major",
                "rhs" : "2.0"
              },
              {
                "operation" : "LTE",
                "lhs" : "q_hana_version:sps",
                "rhs" : "3.0"
              },
              {
                "operation" : "LT",
                "lhs" : "q_hana_version:revision",
                "rhs" : "37.0"
              },
              {
                "operation" : "LT",
                "lhs" : "q_hana_version:patch",
                "rhs" : "3.0"
              }
            ]
          },
          {
            "operation" : "AND",
            "child_evals": [
              {
                "operation" : "EQ",
                "lhs" : "q_hana_version:major",
                "rhs" : "2.0"
              },
              {
                "operation" : "LT",
                "lhs" : "q_hana_version:revision",
                "rhs" : "37.0"
              },
              {
                "operation" : "LT",
                "lhs" : "q_hana_version:patch",
                "rhs" : "42.0"
              }
            ]
          }
        ]
      },
      "actions": [
        {
          "description": "The SAP HANA version is susceptible to CVE-2019-0357, a vulnerability that allows database users with administrator privileges to run operating system commands as root. It is recommended to upgrade your HANA version to resolve this issue. The vulnerability has been fixed in the following versions: \n\nRevision 122.26 for SAP HANA 1.00 SPS12\nRevision 37.03 for SAP HANA 2.0 SPS03\nRevision 42 for SAP HANA 2.0 SPS04."
        }
      ],
      "references": [
        "SAP Note 2829681 - [CVE-2019-0357] Privilege escalation in SAP HANA database,https://me.sap.com/notes/2829681"
      ]
    }
  ]
}
